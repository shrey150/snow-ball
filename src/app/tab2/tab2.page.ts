import { Geolocation } from '@ionic-native/geolocation/ngx';
import { Camera, CameraOptions } from '@ionic-native/camera/ngx';
import { Component } from '@angular/core';

import * as firebase from 'firebase';

@Component({
  selector: 'app-tab2',
  templateUrl: 'tab2.page.html',
  styleUrls: ['tab2.page.scss']
})
export class Tab2Page {

  db: any;
  reportType: any;
  image: String;

  constructor(private geolocation: Geolocation, private camera: Camera) {
    this.db = firebase.database();
  }

  takePicture(): void {

      const options: CameraOptions = {
        quality: 100,
        destinationType: this.camera.DestinationType.FILE_URI,
        encodingType: this.camera.EncodingType.JPEG,
        mediaType: this.camera.MediaType.PICTURE
      };

      this.camera.getPicture(options).then(imageData => {
       this.image = imageData;
      }, err => this.image = "data:image/jpeg;base64,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");

  }

  sendReport(): void {

    this.geolocation.getCurrentPosition().then(pos => {

      this.db.ref('/markers').push({
        lat: pos.coords.latitude,
        long: pos.coords.longitude,
        type: this.reportType,
        img: this.image ? this.image : ''
      })
      .then(() => console.log('report sent'));

    });

  }

}
